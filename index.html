<!DOCTYPE html>
<html lang="lv">
<head>
  <meta charset="UTF-8">
  <title>RED — Veikals / Grozs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { 
      font-family: Arial, sans-serif; 
      max-width: 900px; 
      margin: 0 auto; 
      padding: 20px; 
      background: #555555; /* темно-серый фон */
      color: #fff;
    }
    .products-list { 
      display: flex; 
      flex-wrap: wrap; 
      gap: 20px; 
    }
    .product-card { 
      border: none; /* убрали белую рамку */
      background: #444; /* тёмный фон карточек */
      padding: 15px; 
      width: calc(33% - 20px); 
      box-sizing: border-box; 
      border-radius: 8px;
    }
    .product-card h3 { 
      margin: 10px 0; 
      font-size: 1rem;
    }
    .product-card .price { 
      font-weight: bold; 
      margin-bottom: 10px; 
    }
    .product-card .add-btn { 
      display: inline-block; 
      padding: 8px 12px; 
      background-color: #e60000; 
      color: white; 
      text-decoration: none; 
      cursor: pointer; 
      border-radius: 4px;
    }
    .product-card img {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 0 auto 10px;
      border-radius: 4px;
    }
    .cart-area { 
      margin-top: 40px; 
      padding: 20px; 
      background: #444;
      border-radius: 8px;
    }
    .cart-items { margin-bottom: 20px; }
    .simpleCart_items table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 15px;
    }
    .simpleCart_items th, .simpleCart_items td {
      border: 1px solid #666;
      padding: 8px;
      text-align: center;
      color: #fff;
    }
    .simpleCart_items th {
      background-color: #333;
    }
    .simpleCart_items td.item-name {
      text-align: left;
    }
    .cart-total { font-size: 1.2em; font-weight: bold; }
    .empty-cart-btn { margin-top: 10px; color: #ccc; cursor: pointer; display:inline-block; }
    .delivery-info { 
      margin-top: 30px; 
      padding: 20px; 
      background: #444; 
      border-radius: 8px;
    }
    .delivery-info h2 { margin-top: 0; }
    .delivery-info label {
      display: flex;
      align-items: center; /* радиокнопка и текст на одном уровне */
      margin-bottom: 10px;
      cursor: pointer;
      gap: 10px;
    }
    .delivery-info input[type="radio"] {
      display: inline-block;
      margin: 0;
    }
    #locker-field { margin-top: 10px; }
    #locker-field select { width: 100%; padding: 6px; border-radius: 4px; }
    .order-form { margin-top: 30px; padding: 20px; background: #444; border-radius: 8px; }
    .order-form label { display: block; margin-bottom: 10px; }
    .order-form input, .order-form textarea, .order-form select { width: 100%; padding: 8px; margin-top: 5px; margin-bottom: 15px; box-sizing: border-box; border-radius: 4px; border: none; }
    .order-form button { padding: 10px 20px; background-color: #e60000; color: white; border: none; cursor: pointer; border-radius: 4px; }
    .hidden { display: none; }
    @media (max-width: 900px) {
      .product-card { width: calc(50% - 20px); }
    }
    @media (max-width: 600px) {
      .product-card { width: 100%; }
    }
  </style>
</head>
<body>

  <h1>Mūsu preces</h1>
  <div class="products-list" id="products-list">
    <div class="product-card simpleCart_shelfItem">
      <img src="photo/200.jpg" alt="RED MC200 multivārāmais katls">
      <h3 class="item_name">Multikatls RED COLORSENSE MC200</h3>
      <div class="price"><span class="item_price">139.00</span> EUR</div>
      <a href="javascript:;" class="add-btn item_add">Pievienot grozam</a>
    </div>

    <div class="product-card simpleCart_shelfItem">
      <img src="photo/11E.jpg" alt="Tējkanna Colorsense A11E">
      <h3 class="item_name">Tējkanna Colorsense A11E</h3>
      <div class="price"><span class="item_price">45.00</span> EUR</div>
      <a href="javascript:;" class="add-btn item_add">Pievienot grozam</a>
    </div>

    <div class="product-card simpleCart_shelfItem">
      <img src="photo/15E1.jpg" alt="Tējkanna Colorsense A15E">
      <h3 class="item_name">Tējkanna Colorsense A15E</h3>
      <div class="price"><span class="item_price">49.00</span> EUR</div>
      <a href="javascript:;" class="add-btn item_add">Pievienot grozam</a>
    </div>
  </div>

  <div class="cart-area">
    <h2>Grozs</h2>
    <div class="cart-items">
      <div class="simpleCart_items"></div>
    </div>
    <div class="cart-total">
      Kopā: <span class="simpleCart_total"></span> EUR
    </div>
    <div>
      <a href="javascript:;" class="empty-cart-btn simpleCart_empty">Iztīrīt grozu</a>
    </div>
  </div>

  <!-- Bloks par piegādi -->
  <div class="delivery-info">
    <h2>Piegāde</h2>
    <p>Lūdzu, izvēlieties piegādes veidu:</p>
    <label>
      <input type="radio" name="delivery" value="Venipak pakomāts" required> Venipak pakomāts (1–3 darba dienas, 4.00 EUR)
    </label>
    <div id="locker-field" class="hidden">
      Izvēlieties pakomātu:
      <select id="locker-select">
        <option value="">Ielādē pakomātus...</option>
      </select>
    </div>
    <label>
      <input type="radio" name="delivery" value="Pašizņemšana Mārupē"> Pašizņemšana Mārupē, Lielā 19 k1 (BEZMAKSAS)
    </label>
  </div>

  <div class="order-form">
    <h2>Noformēt pasūtījumu</h2>
    <form id="orderForm" action="https://api.web3forms.com/submit" method="POST">
      <input type="hidden" name="access_key" value="eecfee69-2466-4350-809f-888ed9faac05">
      <input type="hidden" name="email_to" value="info.redmond.lv@gmail.com">
      <input type="hidden" name="cart_contents" id="cart_contents" value="">

      <label>Jūsu vārds:<input type="text" name="customer_name" required></label>
      <label>E-pasts:<input type="email" name="email" required></label>
      <label>Telefons:<input type="text" name="phone"></label>
      <label>Komentāri:<textarea name="message" rows="4"></textarea></label>
      <button type="submit">Pasūtīt</button>
    </form>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/simplecartjs/3.0.5/simplecart.min.js"></script>
  <script>
    $(function() {
      if (typeof simpleCart === 'undefined') {
        console.error('simpleCart nav ielādēts.');
        return;
      }

      simpleCart({
        cartStyle: "table",
        cartColumns: [
          { attr: "name", label: "Prece", className: "item-name" },
          { attr: "quantity", label: "Daudzums" },
          { attr: "price", label: "Cena" },
          { view: "remove", text: "Dzēst" }
        ],
        currency: "EUR",
        checkout: { type: "" }
      });

      // Загрузка пакоматов из JSON
      $.getJSON('venipak-points.json', function(data) {
        const select = $('#locker-select');
        select.empty();
        data.forEach(point => {
          select.append('<option value="'+point.id+'">'+point.city+', '+point.address+' ('+point.pickup_point+')</option>');
        });
      });

      // показываем/скрываем список пакоматов
      $('input[name="delivery"]').on('change', function() {
        if ($(this).val() === "Venipak pakomāts") {
          $('#locker-field').removeClass('hidden');
          $('#locker-select').attr('required', true);
        } else {
          $('#locker-field').addClass('hidden');
          $('#locker-select').removeAttr('required');
        }
      });

      // form submit
      $('#orderForm').on('submit', function(e){
        var items = simpleCart.items();
        if (!items || items.length === 0) {
          alert("Grozs ir tukšs");
          e.preventDefault();
          return false;
        }

        var summaryArr = [];
        for (var i = 0; i < items.length; i++) {
          var it = items[i];
          var qty = it.get('quantity');
          var name = it.get('name');
          var price = parseFloat(it.get('price')).toFixed(2);
          summaryArr.push(qty + ' × ' + name + ' (' + price + ' EUR)');
        }
        var total = parseFloat(simpleCart.total()).toFixed(2);
        var delivery = $('input[name="delivery"]:checked').val() || "Nav izvēlēts";
        var lockerAddr = $('#locker-select option:selected').text();

        var cartText = summaryArr.join('\n') +
                       "\nKopā: " + total + " EUR" +
                       "\nPiegāde: " + delivery;

        if ($('input[name="delivery"]:checked').val() === "Venipak pakomāts") {
          cartText += "\nVenipak pakomāts: " + lockerAddr;
        }

        $('#cart_contents').val(cartText);
      });
    });
  </script>
</body>
</html>
